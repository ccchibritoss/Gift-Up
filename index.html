<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gift Up - –ê—Ä–µ–Ω–¥–∞ NFT</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
            padding-bottom: 70px;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #001f3f;
            display: flex;
            padding: 10px;
            border-top: 1px solid #0074D9;
            z-index: 1000;
        }
        
        .nav-item {
            flex: 1;
            text-align: center;
            padding: 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .nav-item.active {
            background: #0074D9;
        }
        
        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }
        
        /* –í–∫–ª–∞–¥–∫–∏ */
        .tab-content {
            display: none;
            padding: 15px;
            animation: fadeIn 0.3s ease-in;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –ø–æ–¥–∞—Ä–∫–æ–≤ */
        .gifts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }
        
        .gift-card {
            background: #001f3f;
            border-radius: 12px;
            padding: 12px;
            border: 1px solid #0074D9;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .gift-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,116,217,0.3);
        }
        
        .gift-image {
            width: 100%;
            height: 120px;
            border-radius: 8px;
            object-fit: cover;
            margin-bottom: 8px;
            background: #0074D9;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .gift-name {
            font-size: 14px;
            font-weight: 600;
            color: #0074D9;
            margin-bottom: 4px;
        }
        
        .gift-price {
            font-size: 16px;
            font-weight: bold;
            color: #7FDBFF;
            margin-bottom: 4px;
        }
        
        .gift-period {
            font-size: 12px;
            color: #B0B0B0;
        }
        
        /* –ü—Ä–æ—Ñ–∏–ª—å */
        .profile-section {
            text-align: center;
        }
        
        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 2px solid #0074D9;
            margin: 0 auto 15px;
            background: #0074D9;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
        }
        
        .info-card {
            background: #001f3f;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid #0074D9;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .info-item:last-child {
            margin-bottom: 0;
            border-bottom: none;
        }
        
        .buttons-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }
        
        .btn-primary {
            background: #0074D9;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary:hover {
            background: #0056b3;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: transparent;
            color: #0074D9;
            border: 1px solid #0074D9;
            padding: 12px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-secondary:hover {
            background: rgba(0,116,217,0.1);
        }
        
        .stats-section {
            margin-top: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .stat-card {
            background: #001f3f;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #0074D9;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #7FDBFF;
        }
        
        .stat-label {
            font-size: 12px;
            color: #B0B0B0;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-content {
            background: #001f3f;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #0074D9;
            max-width: 300px;
            width: 90%;
            animation: modalAppear 0.3s ease-out;
        }
        
        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .phone-input-container {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }
        
        .country-flag {
            font-size: 24px;
            margin-right: 10px;
        }
        
        #phoneInput {
            flex: 1;
            background: #0a0a0a;
            border: 1px solid #0074D9;
            border-radius: 6px;
            padding: 12px;
            color: white;
            font-size: 16px;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .admin-badge {
            background: #ff4444;
            color: white;
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 10px;
            margin-left: 8px;
        }
        
        .status-connected {
            color: #00ff00;
        }
        
        .status-disconnected {
            color: #ff4444;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –í–∫–ª–∞–¥–∫–∞ –ê—Ä–µ–Ω–¥–∞ -->
        <div id="rent" class="tab-content active">
            <div style="text-align: center; margin-bottom: 20px;">
                <h1 style="color: #0074D9;">üéÅ Gift Up</h1>
                <p style="color: #B0B0B0;">–ê—Ä–µ–Ω–¥–∞ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã—Ö NFT –ø–æ–¥–∞—Ä–∫–æ–≤</p>
            </div>
            <div id="giftsList" class="gifts-grid">
                <!-- –ü–æ–¥–∞—Ä–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ü—Ä–æ—Ñ–∏–ª—å -->
        <div id="profile" class="tab-content">
            <div class="profile-section">
                <div class="avatar" id="userAvatar">üë§</div>
                <h3 id="userName">–ó–∞–≥—Ä—É–∑–∫–∞... <span id="adminBadge" class="admin-badge" style="display: none;">ADMIN</span></h3>
                
                <div class="info-card">
                    <div class="info-item">
                        <span>–ë–∞–ª–∞–Ω—Å:</span>
                        <strong id="balance">0 TON</strong>
                    </div>
                    
                    <div class="info-item">
                        <span>Telegram:</span>
                        <span id="telegramStatus" class="status-disconnected">–ù–µ –ø—Ä–∏–≤—è–∑–∞–Ω</span>
                    </div>
                    
                    <div class="info-item">
                        <span>–¢–µ–ª–µ—Ñ–æ–Ω:</span>
                        <span id="phoneDisplay">–ù–µ —É–∫–∞–∑–∞–Ω</span>
                    </div>
                </div>

                <div class="buttons-container">
                    <button class="btn-primary" onclick="bindTelegram()" id="bindTelegramBtn">
                        üì± –ü—Ä–∏–≤—è–∑–∞—Ç—å Telegram
                    </button>
                    <button class="btn-secondary" onclick="showPhoneModal()">
                        üìû –ü—Ä–∏–≤—è–∑–∞—Ç—å –Ω–æ–º–µ—Ä
                    </button>
                </div>

                <div class="stats-section">
                    <h4 style="color: #0074D9; margin-bottom: 15px;">üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="rentedGifts">0</div>
                            <div class="stat-label">–ê—Ä–µ–Ω–¥–æ–≤–∞–Ω–æ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="myGifts">0</div>
                            <div class="stat-label">–ú–æ–∏ –ø–æ–¥–∞—Ä–∫–∏</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('rent')">
            <div class="nav-icon">üè†</div>
            <span>–ê—Ä–µ–Ω–¥–∞</span>
        </div>
        <div class="nav-item" onclick="switchTab('profile')">
            <div class="nav-icon">üë§</div>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
    <div id="phoneModal" class="modal">
        <div class="modal-content">
            <h3 style="color: #0074D9; margin-bottom: 15px;">üìû –ü—Ä–∏–≤—è–∑–∫–∞ –Ω–æ–º–µ—Ä–∞</h3>
            <div class="phone-input-container">
                <span id="countryFlag" class="country-flag">üá∑üá∫</span>
                <input type="tel" id="phoneInput" placeholder="+7 900 000-00-00" 
                       oninput="formatPhoneNumber(this)">
            </div>
            <div class="modal-buttons">
                <button class="btn-secondary" onclick="closeModal('phoneModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn-primary" onclick="savePhoneNumber()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const CONFIG = {
            ADMIN_ID: "7773057702"
        };

        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
        const Storage = {
            get: (key) => {
                try {
                    return JSON.parse(localStorage.getItem(key)) || null;
                } catch {
                    return localStorage.getItem(key);
                }
            },
            
            set: (key, value) => {
                localStorage.setItem(key, JSON.stringify(value));
            }
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let userData = {};
        let gifts = Storage.get('gifts') || [
            {
                id: 1,
                image: "ü¶ç",
                model: "Golden Ape",
                days: 7,
                price: 5,
                background: "gold",
                pattern: "ape",
                video: "",
                addedBy: "7773057702"
            },
            {
                id: 2,
                image: "üë®‚Äçüé§",
                model: "Crypto Punk",
                days: 14,
                price: 12,
                background: "blue",
                pattern: "punk",
                video: "",
                addedBy: "7773057702"
            }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            const tg = window.Telegram.WebApp;
            
            // –†–∞—Å—à–∏—Ä—è–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
            tg.expand();
            tg.ready();
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (tg.initDataUnsafe.user) {
                const user = tg.initDataUnsafe.user;
                userData = {
                    id: user.id,
                    firstName: user.first_name,
                    lastName: user.last_name,
                    username: user.username
                };
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥–º–∏–Ω–∞
                if (user.id.toString() === CONFIG.ADMIN_ID) {
                    document.getElementById('adminBadge').style.display = 'inline';
                }
                
                updateProfile();
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–¥–∞—Ä–∫–∏
            renderGifts();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–¥–∞—Ä–∫–∏ –≤ localStorage
            Storage.set('gifts', gifts);
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–æ–≤
        function renderGifts() {
            const container = document.getElementById('giftsList');
            container.innerHTML = '';
            
            gifts.forEach(gift => {
                const giftElement = `
                    <div class="gift-card" onclick="rentGift(${gift.id})">
                        <div class="gift-image">${gift.image}</div>
                        <div class="gift-name">${gift.model}</div>
                        <div class="gift-price">${gift.price} TON</div>
                        <div class="gift-period">${gift.days} –¥–Ω–µ–π</div>
                    </div>
                `;
                container.innerHTML += giftElement;
            });
        }

        // –ê—Ä–µ–Ω–¥–∞ –ø–æ–¥–∞—Ä–∫–∞
        function rentGift(giftId) {
            const gift = gifts.find(g => g.id === giftId);
            if (!gift) return;
            
            const tg = window.Telegram.WebApp;
            tg.showPopup({
                title: `–ê—Ä–µ–Ω–¥–∞ ${gift.model}`,
                message: `–°—Ç–æ–∏–º–æ—Å—Ç—å: ${gift.price} TON\n–°—Ä–æ–∫: ${gift.days} –¥–Ω–µ–π\n\n–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∞—Ä–µ–Ω–¥—É?`,
                buttons: [
                    {id: 'confirm', type: 'default', text: '‚úÖ –ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å'},
                    {type: 'cancel', text: '‚ùå –û—Ç–º–µ–Ω–∞'}
                ]
            }, function(buttonId) {
                if (buttonId === 'confirm') {
                    tg.showAlert(`üéâ –í—ã —É—Å–ø–µ—à–Ω–æ –∞—Ä–µ–Ω–¥–æ–≤–∞–ª–∏ ${gift.model} –∑–∞ ${gift.price} TON!`);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    const userStats = Storage.get('userStats') || { rentedGifts: 0, myGifts: 0, balance: 0 };
                    userStats.rentedGifts += 1;
                    Storage.set('userStats', userStats);
                    updateProfile();
                }
            });
        }

        // –ü—Ä–∏–≤—è–∑–∫–∞ Telegram
        function bindTelegram() {
            const tg = window.Telegram.WebApp;
            tg.showAlert('–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–≤—è–∑–∫–∏ Telegram –∞–∫–∫–∞—É–Ω—Ç–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏!');
            
            // –ò–º–∏—Ç–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–∏–≤—è–∑–∫–∏ –¥–ª—è –¥–µ–º–æ
            setTimeout(() => {
                document.getElementById('telegramStatus').textContent = '–ü—Ä–∏–≤—è–∑–∞–Ω';
                document.getElementById('telegramStatus').className = 'status-connected';
                document.getElementById('bindTelegramBtn').style.display = 'none';
            }, 1000);
        }

        // –†–∞–±–æ—Ç–∞ —Å –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        function showPhoneModal() {
            document.getElementById('phoneModal').style.display = 'flex';
            document.getElementById('phoneInput').value = '';
        }

        function formatPhoneNumber(input) {
            let value = input.value.replace(/\D/g, '');
            
            if (value.startsWith('7') || value.startsWith('8')) {
                value = '7' + value.substring(1);
                document.getElementById('countryFlag').textContent = 'üá∑üá∫';
            } else if (value.startsWith('1')) {
                document.getElementById('countryFlag').textContent = 'üá∫üá∏';
            } else if (value.startsWith('44')) {
                document.getElementById('countryFlag').textContent = 'üá¨üáß';
            } else {
                document.getElementById('countryFlag').textContent = 'üè≥Ô∏è';
            }
            
            let formattedValue = '+';
            
            if (value.length > 0) {
                formattedValue += value.substring(0, 1);
            }
            if (value.length > 1) {
                formattedValue += ' (' + value.substring(1, 4);
            }
            if (value.length > 4) {
                formattedValue += ') ' + value.substring(4, 7);
            }
            if (value.length > 7) {
                formattedValue += '-' + value.substring(7, 9);
            }
            if (value.length > 9) {
                formattedValue += '-' + value.substring(9, 11);
            }
            
            input.value = formattedValue;
        }

        function savePhoneNumber() {
            const phone = document.getElementById('phoneInput').value;
            
            if (!phone || phone.length < 10) {
                window.Telegram.WebApp.showAlert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
                return;
            }
            
            Storage.set('userPhone', phone);
            window.Telegram.WebApp.showAlert('‚úÖ –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
            closeModal('phoneModal');
            updateProfile();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
        function updateProfile() {
            const userStats = Storage.get('userStats') || { rentedGifts: 0, myGifts: 0, balance: 0 };
            const userPhone = Storage.get('userPhone');
            
            if (userData.firstName) {
                document.getElementById('userName').textContent = userData.firstName + (userData.lastName ? ' ' + userData.lastName : '');
            }
            
            document.getElementById('balance').textContent = userStats.balance + ' TON';
            document.getElementById('rentedGifts').textContent = userStats.rentedGifts;
            document.getElementById('myGifts').textContent = userStats.myGifts;
            
            if (userPhone) {
                document.getElementById('phoneDisplay').textContent = userPhone;
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –∏—Ö
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
